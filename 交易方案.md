# Version1:

设TWAP每分钟需要成交$V_{demand}$，同时有一个模型$V(t)$，可以预测在这一分钟内的总成交量$V_{predict}$



若$V_{predict} <  V_{demand}$ ， 则这一分钟内市场流动性小于我们所需要的流动性，，直接吃单



若$V_{predict} >  V_{demand}$ ， 则这一分钟内市场流动性大于我们所需要的流动性。可以在t=0s时，把$V_{demand}$按当前盘口$V_{bid_1},V_{bid_2},V_{bid_3}$的比例分成3份，挂在$bid_1，bid_2，bid_3$，10s后撤掉未成交的单。11s时继续按盘口价格和比例挂单，如此重复。直到51s时，剩余未成交的量全部以吃单的形式买入



未考虑的因素：

* 如果$V_{demand}$数量很大，反复挂撤单是否有违规问题

* 未成交的外挂单如果单次被扫完（价格直接被打到$bid_{3}$）是否会造成严重的市场冲击

* 按这种固定模式的挂撤单，容易被对手方识别出意图

# version2:

设TWAP每分钟需要成交$V_{demand}$，同时有一个模型$V(t)$，可以预测在这一分钟内的总成交量$V_{predict}$



**若$V_{predict} <  V_{demand}$ ， 则这一分钟内市场流动性小于我们所需要的流动性**

t = 0 时，挂单分成两档，**将$V_{demand}$按比例分配：**

|            price            |       volume ratio        |
| :-------------------------: | :-----------------------: |
| $ask_1-spread*u(0 < u < 1)$ | $(V_{ask_1}+V_{bid_1})/2$ |
| $bid_1+spread*u(0 < u < 1)$ | $(V_{ask_1}+V_{bid_1})/2$ |

t = 20s时撤单一次，然后重新按比例挂单，40s时撤单。剩余未成交的在59s时吃单。



**若$V_{predict} >  V_{demand}$ ， 则这一分钟内市场流动性大于我们所需要的流动性。**

t = 51s时，挂单分成三档，**将$V_{demand}$按比例分配：**

|  price  | volume ratio |
| :-----: | :----------: |
| $bid_1$ | $V_{bid_1}$  |
| $bid_2$ | $V_{bid_2}$  |
| $bid_3$ | $V_{bid_3}$  |

t = 58s时撤单。剩余未成交的在59s时吃单。



未考虑的因素：

* ~~如果$V_{demand}$数量很大，反复挂撤单是否有违规问题~~

* 未成交的外挂单如果单次被扫完（价格直接被打到$bid_{3}$）是否会造成严重的市场冲击

* ~~按这种固定模式的挂撤单，容易被对手方识别出意图~~





